---
import { getCollection } from 'astro:content';
import ProjectCard from './ProjectCard.astro';
import ProjectModal from './ProjectModal.astro';

// Get all projects from content collection
const allProjects = await getCollection('projects');

// Sort by id and filter to only show projects with id 1-4
const displayedProjects = allProjects
	.sort((a, b) => a.data.id - b.data.id)
	.filter(project => project.data.id >= 1 && project.data.id <= 4);
---

<section class="min-h-screen w-full flex items-center justify-center p-4 bg-Background1">
	<!-- Centered container with curved edges and different background -->
	<div class="w-full max-w-7xl h-auto min-h-[90vh] rounded-2xl p-12 shadow-lg bg-Background2">
		
		<!-- Projects content -->
		<a href="/projects" class="block mb-12">
			<h2 class="text-4xl font-Display1 text-center text-Neutral-Dark transition-all duration-300 hover:text-Primary1 hover:scale-105 cursor-pointer">Projects</h2>
		</a>
		
		<!-- Projects Grid -->
		<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
			{displayedProjects.map((project) => (
				<ProjectCard
					name={project.data.title}
					size={project.data.size}
					image={project.data.image}
					technologies={project.data.tech}
					description={project.data.summary}
					showMoreButton={project.data.showMoreButton}
					link={project.data.link}
					projectId={project.data.id}
				/>
			))}
		</div>

		<!-- More Projects Button -->
		<div class="flex justify-center">
			<a 
				href="/projects" 
				class="px-8 py-3 rounded-lg font-Display2 font-medium text-lg transition-all duration-300 bg-Primary2 text-white hover:-translate-y-0.5 hover:shadow-xl hover:opacity-90"
			>
				More Projects
			</a>
		</div>

	</div>
</section>

<!-- Modal for project details -->
<ProjectModal projects={allProjects} />