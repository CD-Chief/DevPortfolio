---
import { getCollection } from 'astro:content';
import ProjectCard from './ProjectCard.astro';
import ProjectModal from './ProjectModal.astro';

// Get all projects from content collection
const allProjects = await getCollection('projects');

// Sort by id
const sortedProjects = allProjects.sort((a, b) => a.data.id - b.data.id);

// Show first 2 projects on mobile, first 4 on desktop
const displayedProjects = sortedProjects.filter(project => project.data.id >= 1 && project.data.id <= 4);
const mobileProjects = sortedProjects.filter(project => project.data.id >= 1 && project.data.id <= 2);
---

<section class="min-h-screen w-full flex items-center justify-center p-4 bg-Background1">
	<!-- Centered container with curved edges and different background -->
	<div class="w-full max-w-7xl h-auto min-h-[90vh] rounded-2xl p-4 sm:p-6 md:p-12 shadow-lg bg-Background2">
		
		<!-- Projects content -->
		<a href="/projects" class="block mb-12">
			<h2 class="text-4xl font-Display1 text-center text-Neutral-Dark transition-all duration-300 hover:text-Primary1 hover:scale-105 cursor-pointer">Projects</h2>
		</a>
		
		<!-- Projects Grid - Mobile (2 projects) -->
		<div class="grid grid-cols-1 gap-8 mb-12 w-full lg:hidden">
			{mobileProjects.map((project) => (
				<ProjectCard
					name={project.data.title}
					size={project.data.size}
					image={project.data.image}
					technologies={project.data.tech}
					description={project.data.summary}
					showMoreButton={project.data.showMoreButton}
					link={project.data.link}
					projectId={project.data.id}
				/>
			))}
		</div>

	   <!-- Projects Masonry - Desktop (4 projects) -->
	   <div class="hidden lg:block mb-12 w-full columns-2 gap-8">
		   {displayedProjects.map((project) => (
			   <div class="mb-8 break-inside-avoid">
				   <ProjectCard
					   name={project.data.title}
					   size={project.data.size}
					   image={project.data.image}
					   technologies={project.data.tech}
					   description={project.data.summary}
					   showMoreButton={project.data.showMoreButton}
					   link={project.data.link}
					   projectId={project.data.id}
				   />
			   </div>
		   ))}
	   </div>		<!-- More Projects Button -->
		<div class="flex justify-center">
			<a 
				href="/projects" 
				class="px-8 py-3 rounded-lg font-Display2 font-medium text-lg transition-all duration-300 bg-Primary2 text-white hover:-translate-y-0.5 hover:shadow-xl hover:opacity-90"
			>
				More Projects
			</a>
		</div>

	</div>
</section>

<!-- Modal for project details -->
<ProjectModal projects={allProjects} />