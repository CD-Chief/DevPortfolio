---
import ProjectCard from './ProjectCard.astro';
import projectsData from '../data/projects.json';

// Type assertion for the projects data
type ProjectSize = 'S' | 'M' | 'L';
interface Project {
	id: number;
	name: string;
	size: ProjectSize;
	image?: string;
	technologies: string[];
	description: string;
	showMoreButton: boolean;
	link: string;
}

const projects = projectsData as Project[];
---

<section class="min-h-screen w-full flex items-center justify-center p-4 bg-Background1">
	<!-- Centered container with curved edges and different background -->
	<div class="w-full max-w-7xl h-auto min-h-[90vh] rounded-2xl p-12 shadow-lg bg-Background2">
		
		<!-- Header with back button -->
		<div class="flex items-center justify-between mb-8">
			<a 
				href="/" 
				class="px-6 py-2 rounded-lg font-Display2 font-medium transition-all duration-300 bg-Neutral-Dark text-white hover:-translate-y-0.5 hover:shadow-xl hover:opacity-90"
			>
				Home
			</a>
			<h2 class="text-4xl font-Display1 text-center flex-1 text-Neutral-Dark">All Projects</h2>
			<div class="w-[100px]"></div> <!-- Spacer for centering -->
		</div>

		<!-- Filter Input -->
		<div class="flex justify-center mb-12">
			<input 
				type="text" 
				id="techFilter"
				placeholder="Filter by technology (e.g., React, Python)..."
				class="filter-input px-6 py-3 rounded-lg font-Display2 w-full max-w-md border-2 border-Neutral-Dark text-Neutral-Dark transition-all duration-300"
			/>
		</div>
		
		<!-- Projects Grid -->
		<div id="projectsGrid" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
			{projects.map((project) => (
				<div class="project-card" data-technologies={project.technologies.join(', ')}>
					<ProjectCard
						name={project.name}
						size={project.size}
						image={project.image}
						technologies={project.technologies}
						description={project.description}
						showMoreButton={project.showMoreButton}
						link={project.link}
					/>
				</div>
			))}
		</div>

	</div>
</section>

<style>
	.filter-input {
		outline: none;
		background-color: white;
	}

	.filter-input:focus {
		border-width: 3px;
		box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
	}

	.filter-input::placeholder {
		color: #9CA3AF;
	}

	.project-card {
		transition: opacity 0.3s ease, transform 0.3s ease;
	}

	.project-card.hidden {
		display: none;
	}
</style>

<script>
	const filterInput = document.getElementById('techFilter') as HTMLInputElement;
	const projectsGrid = document.getElementById('projectsGrid');

	if (filterInput && projectsGrid) {
		filterInput.addEventListener('input', (e) => {
			const filterValue = (e.target as HTMLInputElement).value.toLowerCase().trim();
			const projectCards = projectsGrid.querySelectorAll('[data-technologies]');

			projectCards.forEach((card) => {
				const technologies = card.getAttribute('data-technologies')?.toLowerCase() || '';
				
				if (filterValue === '' || technologies.includes(filterValue)) {
					card.classList.remove('hidden');
				} else {
					card.classList.add('hidden');
				}
			});
		});
	}
</script>
